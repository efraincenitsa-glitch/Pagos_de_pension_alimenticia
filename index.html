<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<title>Control de Pensi贸n</title>

<!-- Configuraci贸n iPhone -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Pensi贸n">

<!-- ICONO REAL -->
<link rel="apple-touch-icon" sizes="1024x1024" href="icon-1024.png">

<style>
body{
    font-family:-apple-system, Arial;
    background:#0b1220;
    color:white;
    margin:0;
    padding:20px;
}

h1{ text-align:center; }

.card{
    background:#16213e;
    padding:15px;
    border-radius:15px;
    margin-bottom:20px;
}

input,select{
    width:100%;
    padding:10px;
    margin:6px 0;
    border-radius:10px;
    border:none;
    font-size:16px;
}

button{
    width:100%;
    padding:12px;
    margin-top:10px;
    border:none;
    border-radius:12px;
    background:#0b5cff;
    color:white;
    font-size:16px;
}

.historial-item{
    background:#1f2a4a;
    padding:12px;
    border-radius:12px;
    margin-bottom:10px;
}

.small{
    font-size:13px;
    opacity:.8;
}
</style>
</head>

<body>

<h1> Control Pensi贸n</h1>

<div class="card">
<label>Porcentaje (%)</label>
<input type="number" id="porcentaje">

<label>Ingreso ($)</label>
<input type="number" id="ingreso">

<label>Periodicidad</label>
<select id="periodo">
<option>Semanal</option>
<option>Catorcenal</option>
<option>Quincenal</option>
<option>Mensual</option>
</select>

<button onclick="guardar()">Guardar registro</button>
</div>

<div class="card">
<h2>Historial</h2>
<div id="lista"></div>
<button onclick="borrarTodo()">Borrar historial</button>
</div>

<script>
let datos = JSON.parse(localStorage.getItem("pensionDatos")) || [];

//  Fecha autom谩tica
function fechaActual(){
    const f = new Date();
    return f.toLocaleDateString("es-MX");
}

// C谩lculo mensual aproximado
function calcularMensual(monto,periodo){
    if(periodo==="Semanal") return monto*4.33;
    if(periodo==="Catorcenal") return monto*2.17;
    if(periodo==="Quincenal") return monto*2;
    return monto;
}

function guardar(){
    const p = parseFloat(porcentaje.value);
    const i = parseFloat(ingreso.value);
    const per = periodo.value;

    if(!p || !i) return alert("Completa los datos");

    const pago = i*(p/100);
    const libre = i - pago;

    datos.unshift({
        fecha: fechaActual(),
        porcentaje:p,
        ingreso:i,
        periodo:per,
        pago,
        libre,
        mensual: calcularMensual(pago,per)
    });

    localStorage.setItem("pensionDatos",JSON.stringify(datos));

    porcentaje.value="";
    ingreso.value="";
    mostrar();
}

function eliminar(index){
    if(confirm("驴Eliminar registro?")){
        datos.splice(index,1);
        localStorage.setItem("pensionDatos",JSON.stringify(datos));
        mostrar();
    }
}

function editar(index){
    const d = datos[index];
    porcentaje.value = d.porcentaje;
    ingreso.value = d.ingreso;
    periodo.value = d.periodo;
    eliminar(index);
}

function borrarTodo(){
    if(confirm("驴Borrar todo el historial?")){
        datos = [];
        localStorage.removeItem("pensionDatos");
        mostrar();
    }
}

function mostrar(){
    lista.innerHTML="";
    let total=0;

    datos.forEach((d,i)=>{
        total += d.pago;

        lista.innerHTML += `
        <div class="historial-item">
            <b>${d.fecha}</b><br>
            ${d.porcentaje}% de $${d.ingreso.toFixed(2)} (${d.periodo})<br>
             Pago: $${d.pago.toFixed(2)}<br>
             Libre: $${d.libre.toFixed(2)}<br>
             Mensual aprox: $${d.mensual.toFixed(2)}
            <div class="small">
                <button onclick="editar(${i})">Editar</button>
                <button onclick="eliminar(${i})">Eliminar</button>
            </div>
        </div>`;
    });

    if(datos.length)
        lista.innerHTML += `<h3>Total pagado: $${total.toFixed(2)}</h3>`;
}

mostrar();
</script>

</body>
</html>
